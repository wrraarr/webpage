<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Oven Clock & Timer</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background: #111;
      font-family: monospace;
      color: #0f0;
      overflow: hidden;
    }

    .oven {
      background: #000;
      padding: 20px 40px;
      border-radius: 12px;
      box-shadow: inset 0 0 15px #0f0, 0 0 25px #050;
      text-align: center;
    }

    #display {
      font-size: 3em;
      letter-spacing: 5px;
      margin-bottom: 20px;
      font-weight: bold;
      text-shadow: 0 0 8px #0f0;
      min-width: 220px;
      white-space: pre;
    }

    .btns {
      display: flex;
      gap: 20px;
      justify-content: center;
    }

    button {
      padding: 12px 20px;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      background: #333;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 0 5px #000;
    }

    button:active {
      background: #555;
    }

    /* Running animations */
    .chicken, .cat {
      position: absolute;
      bottom: 20px;
      width: 100px;
    }

    .chicken {
      left: -150px;
      animation: runAcross 6s linear forwards, bob 0.6s ease-in-out infinite;
    }

    .cat {
      left: -200px;
      width: 120px;
      animation: runAcross 6s linear forwards 0.8s, bob 0.5s ease-in-out infinite;
    }

    @keyframes runAcross {
      0%   { left: -200px; }
      100% { left: 110vw; }
    }

    @keyframes bob {
      0%, 100% { transform: translateY(0); }
      50%      { transform: translateY(-10px); }
    }
  </style>
</head>
<body>
  <div class="oven">
    <div id="display">12:00</div>
    <div class="btns">
      <button id="funcBtn">Function</button>
      <button id="downBtn">↓</button>
      <button id="upBtn">↑</button>
    </div>
  </div>

  <script>
    const display = document.getElementById("display");
    const funcBtn = document.getElementById("funcBtn");
    const upBtn = document.getElementById("upBtn");
    const downBtn = document.getElementById("downBtn");

    let mode = "clock";
    let setMode = false;
    let settingPart = "hours";

    // clock state
    let clock = new Date();
    clock.setHours(12, 0, 0, 0);
    let clockSet = false;

    // timer state
    let timer = { m: 0, s: 0, running: false };

    let blink = true;
    let alarmOn = false;

    // Audio
    let audioCtx = null;
    let beepOsc = null;
    function ensureAudio() {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      if (audioCtx.state === 'suspended') audioCtx.resume().catch(()=>{});
    }
    function startBeep() {
      ensureAudio();
      if (beepOsc) return;
      beepOsc = audioCtx.createOscillator();
      beepOsc.type = "square";
      beepOsc.frequency.value = 1000;
      let gain = audioCtx.createGain();
      gain.gain.value = 0.1;
      beepOsc.connect(gain).connect(audioCtx.destination);
      beepOsc.start();
    }
    function stopBeep() {
      if (beepOsc) { try { beepOsc.stop(); } catch{}; beepOsc.disconnect(); beepOsc=null; }
    }
    function shortBeep() { ensureAudio(); startBeep(); setTimeout(stopBeep,200); }

    function format(n){ return n.toString().padStart(2,"0"); }

    function get12Hour(h) {
      let ampm = (h>=12) ? "PM" : "AM";
      let hour12 = h % 12;
      if (hour12 === 0) hour12 = 12;
      return {h:hour12, ampm};
    }

    function updateDisplay() {
      let text = "";

      if (mode==="clock") {
        let {h, ampm} = get12Hour(clock.getHours());
        // let hh = format(h);
        // let hh = (h < 10) ? h : h.toString();   // 1–9 = "1"…"9", 10–12 stay "10"…"12"
        let hh = (h < 10) ? "\u00A0" + h : h.toString();


        let mm = format(clock.getMinutes());

        // colon blinks in run mode
        let colon = (blink && !setMode && clockSet) ? ":" : (setMode || !clockSet) ? ":" : " ";

        if (!clockSet) {
          // not set yet → blink whole display
          if (!blink) { hh="  "; mm="  "; }
        } else if (setMode) {
          // only blink the active part
          if (settingPart==="hours" && !blink) hh="  ";
          if (settingPart==="minutes" && !blink) mm="  ";
        }

        text = `${hh}${colon}${mm}`;// ${ampm}`;
      } else {
        let mm = format(timer.m);
        let ss = format(timer.s);
        let colon = ":"; 

        if (setMode) {
          if (settingPart==="minutes" && !blink) mm="  ";
          if (settingPart==="seconds" && !blink) ss="  ";
        }
        text = `${mm}${colon}${ss}`;
      }

      display.textContent=text;
    }

    

    // Function hold vs tap
    let holdTimer=null, holdFired=false;
    const HOLD_MS=800;

    funcBtn.addEventListener("pointerdown",e=>{
      e.preventDefault();
      holdFired=false;
      if (holdTimer) clearTimeout(holdTimer);
      holdTimer=setTimeout(()=>{
        holdFired=true;
        if (mode==="clock") {
          setMode=true;
          clockSet=true;
          settingPart="hours";
          shortBeep();
        } else if (mode==="timer") {
          timer.m=0; timer.s=0; timer.running=false; alarmOn=false; stopBeep();
        }
        updateDisplay();
        holdTimer=null;
      },HOLD_MS);
    });

    function endFuncPress(e){
      e && e.preventDefault();
      if (holdTimer){ clearTimeout(holdTimer); holdTimer=null; }
      if (holdFired){ holdFired=false; return; }

      if (!setMode){
        mode=(mode==="clock")?"timer":"clock";
      } else {
        if (mode==="clock"){
          if (settingPart==="hours"){ settingPart="minutes"; }
          else { setMode=false; clockSet=true; }
        } else {
          if (settingPart==="minutes"){ settingPart="seconds"; }
          else { setMode=false; }
        }
      }
      shortBeep();
      updateDisplay();
    }
    funcBtn.addEventListener("pointerup",endFuncPress);
    funcBtn.addEventListener("pointercancel",()=>{ if(holdTimer){clearTimeout(holdTimer);} holdFired=false; });
    funcBtn.addEventListener("contextmenu",e=>e.preventDefault());

    function stopAlarmIfOn(){ if(alarmOn){ alarmOn=false; stopBeep(); } }

    upBtn.addEventListener("click",()=>{
      ensureAudio(); stopAlarmIfOn();
      if (mode==="clock" && setMode){
        if (settingPart==="hours"){
          clock.setHours((clock.getHours()+1)%24);
        } else {
          clock.setMinutes((clock.getMinutes()+1)%60);
        }
      } else if (mode==="timer"){
        if (setMode && settingPart==="seconds"){
          timer.s=(timer.s+1)%60;
        } else {
          timer.m=(timer.m+1)%100;
          timer.running=true;
        }
      }
      updateDisplay();
    });

    downBtn.addEventListener("click",()=>{
      ensureAudio(); stopAlarmIfOn();
      if (mode==="clock" && setMode){
        if (settingPart==="hours"){
          clock.setHours((clock.getHours()+23)%24);
        } else {
          clock.setMinutes((clock.getMinutes()+59)%60);
        }
      } else if (mode==="timer"){
        if (setMode && settingPart==="seconds"){
          timer.s=(timer.s+59)%60;
        } else {
          timer.m=(timer.m+99)%100;
          timer.running=true;
        }
      }
      updateDisplay();
    });


    /*  ╔═══════════════════════════════════════════════════════════╗
    ║ ⚠️  SPOILER ALERT – READ NO FURTHER! ⚠️                       ║
    ║                                                               ║
    ║ Dear I101 Adventurer,                                         ║
    ║ You have wandered too far into the source code...             ║
    ║ Beyond this point lie secrets that will RUIN the surprise!    ║
    ║                                                               ║
    ║ 👉 Turn back now, enjoy the artifact as intended.             ║
    ║                                                               ║
    ║ Only the bravest (or nosiest 👀) will peek ahead.             ║
    ║ But remember: you can’t unsee spoilers!                       ║
    ║                                                               ║
    ║            ✨ Consider yourself officially warned. ✨         ║
    ╚═══════════════════════════════════════════════════════════════╝
    */


    setInterval(()=>{
      blink=!blink;

      if (!setMode && clockSet) clock.setSeconds(clock.getSeconds()+1);

      if (!setMode && timer.running) {
        if (timer.m>0||timer.s>0) {
          if (--timer.s<0) { timer.s=59; timer.m--; }
        } else {
          timer.running=false; alarmOn=true; startBeep();
          if (clockSet) triggerChickenAndCat();
        }
      }

      updateDisplay();
    },1000);


    // Chicken + Cat animation
    function triggerChickenAndCat() {
      // chicken
      const chicken = document.createElementNS("http://www.w3.org/2000/svg","svg");
      chicken.setAttribute("viewBox","0 0 120 100");
      chicken.classList.add("chicken");
      chicken.innerHTML = `
        <circle cx="40" cy="50" r="20" fill="white" stroke="black"/>
        <circle cx="70" cy="35" r="15" fill="white" stroke="black"/>
        <circle cx="75" cy="32" r="3" fill="black"/>
        <polygon points="85,35 100,30 85,25" fill="orange"/>
        <line x1="30" y1="70" x2="20" y2="90" stroke="orange" stroke-width="4"/>
        <line x1="50" y1="70" x2="60" y2="90" stroke="orange" stroke-width="4"/>
        <path d="M70 20 q5 -10 10 0" fill="red"/>
      `;
      document.body.appendChild(chicken);
      chicken.addEventListener("animationend",()=>chicken.remove());

      // cat (slight delay)
      const cat = document.createElementNS("http://www.w3.org/2000/svg","svg");
      cat.setAttribute("viewBox","0 0 140 100");
      cat.classList.add("cat");
      cat.innerHTML = `
        <ellipse cx="60" cy="50" rx="35" ry="20" fill="gray" stroke="black"/>
        <circle cx="100" cy="50" r="20" fill="gray" stroke="black"/>
        <polygon points="115,35 125,15 135,35" fill="gray" stroke="black"/>
        <circle cx="105" cy="45" r="4" fill="black"/>
        <polygon points="40,70 30,90 50,90" fill="gray" stroke="black"/>
        <polygon points="80,70 70,90 90,90" fill="gray" stroke="black"/>
        <path d="M20 50 q-15 -10 -20 0 q5 15 20 10" fill="gray" stroke="black"/>
      `;
      document.body.appendChild(cat);
      cat.addEventListener("animationend",()=>cat.remove());
    }

    updateDisplay();
  </script>
</body>
</html>
